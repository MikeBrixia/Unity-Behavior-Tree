<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Decorator </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Decorator ">
    <meta name="generator" content="docfx ">
  
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.min.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.json">
    <meta property="docfx:tocrel" content="toc.json">
  
  
  
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="decorator">Decorator</h1>

<p>When creating a custom decorator node you will find the following inside the created .cs file:</p>
<pre><code class="lang-csharp">
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using BT.Runtime;

public sealed class NewDecorator : BT_Decorator
{
    // Called when this action gets initialized.
    protected override void OnInit()
    {
    }
    
    // Called when the behavior tree starts executing this decorator
    protected override void OnStart()
    {
    }
    
    // Called when the behavior tree stops executing this decorator
    protected override void OnStop()
    {
    }
    
    // Called when the behavior tree wants to execute this decorator.
    // Modify the 'state' as you need, return SUCCESS when you want this node
    // to succeed, RUNNING when you want to notify the tree that this node is still running
    // and has not finished yet and FAILED when you want this node to fail
    public override ENodeState Execute()
    {
        return state;
    }
    
// Put here editor only logic
#if UNITY_EDITOR
    
    public NewDecorator() : base()
    {
        // Initialize editor-only properties here...
        description = &quot;Node description&quot;;
    }
#endif
}

</code></pre>
<div class="NOTE">
<h5>Note</h5>
<p>By default, decorator will be created as <b>sealed classes</b>; this is done to prevent developers from creating other nodes which derives from the current one. As a general rule, composites should only derive from: <b>BT_Decorator</b> type.</p>
</div>
<h2 id="initialization">Initialization</h2>
<p>The <b>OnInit()</b> method will be called before the first behavior tree execution update and it is used to initialize properties.
It is called before the start function and only when the behavior tree gets clone/created at runtime.
the <a href="https://unity-behavior-tree-docs.netlify.app/api/bt.runtime.behaviortreecomponent#BT_Runtime_BehaviorTreeComponent_RunBehaviorTree_BT_Runtime_BehaviorTree_">RunBehaviorTree()</a> method,
for example, will create a copy of the supplied behavior tree asset and run it, therefore triggering the OnInit() method on each of the cloned tree nodes.</p>
<pre><code class="lang-csharp">// Called when the behavior tree starts executing this action
protected override void OnInit()
{
    // Initialize properties here...
}
</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>You should use the OnInit() method only to initialize only one-time properties.
For properties which could change over tree updates, please look at the OnStart() method.</p>
</div>
<h2 id="start">Start</h2>
<p>This is the method which gets called when the node begins executing, meaning that it will be called before the <b>Execute</b> function.</p>
<pre><code class="lang-csharp">
// Called when the behavior tree starts executing this decorator
protected override void OnStart()
{
    // Initialize properties here...
}

</code></pre>
<div class="TIP">
<h5>Tip</h5>
<p>Usually on start is used to initialize properties and retrieve key info from the blackboard.</p>
</div>
<h2 id="stop">Stop</h2>
<p>This method gets called when the decorator fails or gets executed successfully.</p>
<pre><code class="lang-csharp">
// Called when the behavior tree stops executing this decorator
protected override void OnStop()
{
}

</code></pre>
<h2 id="execute">Execute</h2>
<p>Execute is the most important function for decorator nodes and it's used to perform the branch handling logic. Return type for this function it's also important and there can be three different types:</p>
<ul>
<li>SUCCESS when the decorator condition is met.</li>
<li>FAILED when the decorator condition is not met.</li>
<li>RUNNING when the decorator needs more than one update to evaluate.</li>
<li>WAITING is only used internally, i reccomend to never return this state because it could lead
to unexpected behavior.</li>
</ul>
<p>The <a href="https://unity-behavior-tree-docs.netlify.app/api/bt.runtime.bt_node#BT_Runtime_BT_Node_state">state member variable</a> is used to handle and keep
track of nodes state through tree updates, so <b>when you want to modify the state of the node, you must also modify this variable</b>.</p>
<pre><code class="lang-csharp">
// Called when the behavior tree wants to execute this decorator.
public override EBehaviorTreeState Execute()
{
    // 1. Perform task...
    ...

    // 2. Depending on task result, update node state
    state = // Updated state.

    return state;
}

</code></pre>
<h2 id="editor-only">Editor only</h2>
<p>Code which should control how a certain node appears or which editor-only properties,
should be placed inside the following pre-processor condition.</p>
<pre><code class="lang-csharp">
// Put here editor only logic
#if UNITY_EDITOR
    
    // Editor-only code here...

#endif

</code></pre>
<p>Doing so, will ensure that nodes editor related properties will be stripped from release versions of the game.</p>
<p>If you want your nodes to have certains properties displayed by default inside the editor, you can initialize them
inside the constructor.</p>
<pre><code class="lang-csharp">
// Initialize editor-only properties here...
public NewAction() : base()
{
    description = &quot;Node description&quot;;
}

</code></pre>
<p>Here, for example, we're telling Unity to display &quot;Node Description&quot; as the default description for all nodes of type NewDecorator when they get
created inside the editor graph.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/MikeBrixia/Unity-Behavior-Tree/blob/main/Documentation~/articles/decorator.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
